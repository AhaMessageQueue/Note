前面分析了一下关于ws的基本知识，我们知道，wsdl是ws中很重要的文档，我们可以通过解析该wsdl文档获取ws的相关信息，其实，如果不了解该文档结构的话，问题也不大，只要会解析即可进行开发。但是如果想要生成一个符合自己项目的，或者比较人性化的一个wsdl的话，或者从可读性角度来说，就需要在编写ws代码时进行一些相应的配置了，比如说ws名称，参数等等，那么就需要对wsdl文档有一定的了解。这篇文章主要从两个角度来展开：一是解释一下wsdl中的相关配置，二是如何在ws程序中通过注解指定这些配置。

## 1. wsdl配置详解
要生成wsdl，首先得有一个ws，我们还是使用前面文章中提到的那个简单的ws，如下：

```
@WebService //默认静态方法是不能发布成ws服务的
public class MyWebService {

    public String sayHello(String name) {
        return name + " 你好！";
    }

    public static void main(String[] args) {
        String address = "http://192.168.10.1:6666/ws";
        Endpoint.publish(address, new MyWebService());
        System.out.println("访问WSDL的地址为：" + address + "?WSDL");
    }
}
```

运行一下，即可开启ws服务，请求**http://192.168.10.1:6666/ws?WSDL**即可看到wsdl页面，接下来分析一下该wsdl文件中与上面程序中的对应关系，看下图（为了清晰的展示，图我就不缩小了）： 

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- Published by JAX-WS RI (http://jax-ws.java.net). RI's version is JAX-WS RI 2.2.9-b130926.1035 svn-revision#5f6196f2b90e9460065a4c2f4e30e065b245e51e. -->
<!-- Generated by JAX-WS RI (http://jax-ws.java.net). RI's version is JAX-WS RI 2.2.9-b130926.1035 svn-revision#5f6196f2b90e9460065a4c2f4e30e065b245e51e. -->
<definitions name="MyWebServiceService" targetNamespace="http://ws.commons.github.com/" xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://ws.commons.github.com/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" xmlns:wsp1_2="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
    <types>
        <xsd:schema>
            <xsd:import schemaLocation="http://127.0.0.1:6666/ws?xsd=1" namespace="http://ws.commons.github.com/"/>
        </xsd:schema>
    </types>
    <message name="sayHello">
        <part name="parameters" element="tns:sayHello"/>
    </message>
    <message name="sayHelloResponse">
        <part name="parameters" element="tns:sayHelloResponse"/>
    </message>
    <!--
        operation name：方法的名称
        input message：接收参数
        output message：返回值

        为了跨平台，所有的wsdl文件描述都采用的是schema
    -->
    <portType name="MyWebService">
        <operation name="sayHello">
            <input message="tns:sayHello" wsam:Action="http://ws.commons.github.com/MyWebService/sayHelloRequest"/>
            <output message="tns:sayHelloResponse" wsam:Action="http://ws.commons.github.com/MyWebService/sayHelloResponse"/>
        </operation>
    </portType>
    <!--
        name：真正实现此ws服务的名称（不重要）
        style：实现此服务的真实类型
        transport：soap服务
        operation：此服务可以提供被调用的方法
    -->
    <binding name="MyWebServicePortBinding" type="tns:MyWebService">
        <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
        <operation name="sayHello">
            <soap:operation soapAction=""/>
            <input>
                <soap:body use="literal"/>
            </input>
            <output>
                <soap:body use="literal"/>
            </output>
        </operation>
    </binding>
    <!--
        生成的ws“服务的名称”是在原来的类后面又加了个Service而已，“服务类型的名称”是在原来的类后面加了个Port
        service name：指定ws服务的名称，通过此名称获取ws服务。
        port name：此服务下面提供的服务端口（服务类型：post get soap1.1 soap1.2）
            - address location：服务的访问地址，如果要查看wsdl说明，则在此地址后面添加"?WSDL"
     -->
    <service name="MyWebServiceService">
        <port name="MyWebServicePort" binding="tns:MyWebServicePortBinding">
            <soap:address location="http://127.0.0.1:6666/ws"/>
        </port>
    </service>
</definitions>
```
我们可以看到，生成的ws服务名称是在原来的类后面有加了个Service而已，服务类型名是在原来的类后面加了个Port，还包括参数默认为arg0，返回值为return 等等，
这些都能从wsdl文件中看的出来，通过这个wsdl生成的Java代码中的类名自然也就是默认的了，如果我们想要修改这些默认的配置，则需要在编写ws的时候通过注解来设置一下。

## 2. 使用注解修改wsdl配置
我们修改一下上面的ws，使用注解来配置我们自己需要的名称，如下

```
package com.github.commons.ws;

import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.xml.ws.Endpoint;

/**
 * Created by 刘春龙 on 2017/4/24.
 * <p>
 * 自定义ws服务, jdk1.6版本仅仅支持 soap1.1格式,jdk1.7及以上版本支持 soap1.2格式
 * 发布ws服务只需要@WebService注解即可, 如果想要更好的可维护性,则可以通过注解来实现
 */
@WebService // 默认静态的方式是不能发布ws服务的
        (
                name = "MyWebService2",// 服务实现的名称
                serviceName = "MyWebServiceService2",// 服务的名称，默认在发布的服务实现的名称后面添加Service
                portName = "MyWebServicePort2",// 服务类型的名称，默认在发布的服务实现的名称后面添加Port
                targetNamespace = "ws.app.client"// 发布ws服务的命名空间，此空间默认为当前服务包路径的"倒写"，此名称也是 wsimport 命令生成java类时默认的包路径 -p
        )
public class MyWebService {

    @WebMethod(exclude = true)  // 默认public方法可以发布为ws服务, 如果要排除则配置  exclude=true
    public String sayHello(String name) {
        return name + ",你好！";
    }

    //可以指定wsdl中的方法名，参数名和返回值
    @WebMethod(operationName = "sayHello")
    public
    @WebResult(name = "result")
    String sayHello2(@WebParam(name = "name") String name, @WebParam(name = "age") int age) {
        return name + ",你好!年龄为:" + age;
    }

    public static void main(String[] args) {
        // 一个端口可以发布多个ws服务
        String address = "http://127.0.0.1:8888/ws";
        // 创建一个服务端点, banding服务的实现类
        Endpoint.publish(address, new MyWebService());
        System.out.println("访问wsdl的地址为:" + address + "?WSDL");
    }
}

```
通过上面这些注解，我将ws服务相关的信息给重新配置了，运行一下，来对比注解看一下生成的wsdl： 

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- Published by JAX-WS RI (http://jax-ws.java.net). RI's version is JAX-WS RI 2.2.9-b130926.1035 svn-revision#5f6196f2b90e9460065a4c2f4e30e065b245e51e. -->
<!-- Generated by JAX-WS RI (http://jax-ws.java.net). RI's version is JAX-WS RI 2.2.9-b130926.1035 svn-revision#5f6196f2b90e9460065a4c2f4e30e065b245e51e. -->
<definitions name="MyWebServiceService2" targetNamespace="ws.app.client" xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="ws.app.client" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" xmlns:wsp1_2="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
    <types>
        <xsd:schema>
            <xsd:import schemaLocation="http://127.0.0.1:8888/ws?xsd=1" namespace="ws.app.client"/>
        </xsd:schema>
    </types>
    <message name="sayHello">
        <part name="parameters" element="tns:sayHello"/>
    </message>
    <message name="sayHelloResponse">
        <part name="parameters" element="tns:sayHelloResponse"/>
    </message>
    <portType name="MyWebService2">
        <operation name="sayHello">
            <input message="tns:sayHello" wsam:Action="ws.app.client/MyWebService2/sayHelloRequest"/>
            <output message="tns:sayHelloResponse" wsam:Action="ws.app.client/MyWebService2/sayHelloResponse"/>
        </operation>
    </portType>
    <binding name="MyWebServicePort2Binding" type="tns:MyWebService2">
        <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
        <operation name="sayHello">
            <soap:operation soapAction=""/>
            <input>
                <soap:body use="literal"/>
            </input>
            <output>
                <soap:body use="literal"/>
            </output>
        </operation>
    </binding>
    <service name="MyWebServiceService2">
        <port name="MyWebServicePort2" binding="tns:MyWebServicePort2Binding">
            <soap:address location="http://127.0.0.1:8888/ws"/>
        </port>
    </service>
</definitions>
```

可以看出，生成的wsdl中的配置完全按照我们自己指定的来，这样通过解析该wsdl文件得到的java代码中的类以及方法也是按照自定义的来，这就能满足实际中具体的要求了。 